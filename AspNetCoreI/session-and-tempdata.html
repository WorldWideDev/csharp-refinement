<h1>Session and TempData</h1>
<h3>Session</h3>
<p>
    If we want our data to persist across multiple HTTP requests we're going to need to use session. To enable our web application to use session, we will need to modify our Startup class.
</p>
<h3>Startup.cs</h3>
<pre data-language="csharp" class="active_pre rainbow">public void ConfigureServices(IServiceCollection services)
{
    services.AddSession();
    services.AddMvc();
}
// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
public void Configure(IApplicationBuilder app, IHostingEnvironment env)
{
    // other configurations
    app.UseSession();
    app.UseMvc();
}
</pre>
<p>
    And with that, we have the session available for use. There are some limitations to the kind of data we can store in session. In ASP.NET Core MVC we can only use the session to hold on to integers and strings by default. We have to specify what kind of data the session contains both when we set it, and when we retrieve it.
</p>
<p>
    In order to use Session in our controllers we need a new using statement:
</p>
<pre data-language="csharp" class="rainbow">    using Microsoft.AspNetCore.Http;
</pre>
<p>
    And now inside of our controller methods, we can utilize session:
</p>
<pre data-language="csharp" class="rainbow">    
// *Inside controller methods*
// To store a string in session we use ".SetString"
// The first string passed is the key and the second is the value we want to retrieve later
HttpContext.Session.SetString("UserName", "Samantha");
// To retrieve a string from session we use ".GetString"
string LocalVariable = HttpContext.Session.GetString("UserName");
 
// To store an int in session we use ".SetInt32"
HttpContext.Session.SetInt32("UserAge", 28);
 
// To retrieve an int from session we use ".GetInt32"
int? IntVariable = HttpContext.Session.GetInt32("UserAge");
</pre>
<p>
    You may have noticed that when retrieving an int from session we have to store it in an
    <code>int?</code>
    variable, rather than an
    <code>int</code>
    . This is because
    <code>int</code>
    variables are non-nullable; any session variable could contain a null value so we have to use the nullable-int type
    <code>int?</code>
    .
</p>
<!-- is it too much here to show them how to update a value, like an int? I've had a lot of students get hung up on the counter, not understanding that they must get the value out, cast/update, then re-set; maybe we elaborate more in previous chapters where we explain what getters and setters are actually doing, and that we're constantly calling them? It's just here, session makes us do it explicitly -->
<p>
    We can clear our session with the
    <code>Clear</code>
    method:
</p>
<pre data-language="csharp" class="rainbow">HttpContext.Session.Clear();</pre>

<h4>TempData</h4>
<p>While ViewBag and ModelState can hold complex data, we found one of their limitations to be that they do not persist across a redirect. <code>TempData</code> is a tool built on session and is available to the Razor engine once application is configured to use session. It is like a temporary session dictionary that only persists across one redirect, but, like session, only holds string and int values by default.</p>
<pre data-language="csharp" class="rainbow">using Microsoft.AspNetCore.Http;
 
// Other code
public IActionResult Method()
{
    TempData["Variable"] = "Hello World";
    return RedirectToAction("OtherMethod");
}
public IActionResult OtherMethod()
{
    Console.WriteLine(TempData["Variable"]);
    // writes "Hello World" if redirected to from Method()
    return View();
}
</pre>
<h4>OtherMethod.cshtml</h4>
<pre data-language="csharp" class="rainbow">
    // display TempData in html
    <p>@TempData["Variable"]</p>
</pre>
